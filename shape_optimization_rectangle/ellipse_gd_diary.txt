
cparams = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

             maxiter: 100
              report: 1
                 eps: 1.0000e-04
              hspace: 0.0100
     line_search_eps: 1.0000e-06
    line_search_beta: 0.5000

Now we do the actual optimization
Finding eigenvalue ...
Time to find eigenvalue: 5.66e+01
Finding ymax_final ...
Time to find ymax_final: 9.94e-01
Finding eigenvalue ...
Time to find eigenvalue: 5.28e+01
Finding ymax_final ...
Time to find ymax_final: 6.73e-01
Finding eigenvalue ...
Time to find eigenvalue: 5.35e+01
Finding ymax_final ...
Time to find ymax_final: 5.85e-01
Finding eigenvalue ...
Time to find eigenvalue: 4.89e+01
Finding ymax_final ...
Time to find ymax_final: 7.86e-01
iter: 1, loss: -2.55e-01, grad: 1.85e-01, 2nd-deri: 3.49e-01 
Current weight 1.62821195113185
Finding eigenvalue ...
Time to find eigenvalue: 5.54e+01
Finding ymax_final ...
Time to find ymax_final: 7.15e-01
Finding eigenvalue ...
Time to find eigenvalue: 4.76e+01
Finding ymax_final ...
[Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.820233e-16.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('id', '/Users/zijianwang/Documents/MATLAB/FLAM/core/id.m', 120)" style="font-weight:bold">id</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/FLAM/core/id.m',120,0)">line 120</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chnk.flam.nproxy_square', '/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/+chnk/+flam/nproxy_square.m', 56)" style="font-weight:bold">chnk.flam.nproxy_square</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/+chnk/+flam/nproxy_square.m',56,0)">line 56</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerflam', '/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/chunkerflam.m', 176)" style="font-weight:bold">chunkerflam</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/chunkerflam.m',176,0)">line 176</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('helm_dprime', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/helm_dprime.m', 17)" style="font-weight:bold">helm_dprime</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/helm_dprime.m',17,0)">line 17</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('max_grad', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/max_grad.m', 6)" style="font-weight:bold">max_grad</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/max_grad.m',6,0)">line 6</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ellipse_loss', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/ellipse_loss.m', 25)" style="font-weight:bold">ellipse_loss</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/ellipse_loss.m',25,0)">line 25</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('optim.gd_grad_1d', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_grad_1d.m', 13)" style="font-weight:bold">optim.gd_grad_1d</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_grad_1d.m',13,0)">line 13</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('optim.gd_1d', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_1d.m', 49)" style="font-weight:bold">optim.gd_1d</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_1d.m',49,0)">line 49</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test_ellipse_gd', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/test_ellipse_gd.m', 24)" style="font-weight:bold">test_ellipse_gd</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/test_ellipse_gd.m',24,0)">line 24</a>)
] 
Time to find ymax_final: 6.32e-01
Finding eigenvalue ...
Time to find eigenvalue: 5.34e+01
Finding ymax_final ...
[Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.661127e-16.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('id', '/Users/zijianwang/Documents/MATLAB/FLAM/core/id.m', 120)" style="font-weight:bold">id</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/FLAM/core/id.m',120,0)">line 120</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chnk.flam.nproxy_square', '/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/+chnk/+flam/nproxy_square.m', 56)" style="font-weight:bold">chnk.flam.nproxy_square</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/+chnk/+flam/nproxy_square.m',56,0)">line 56</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerflam', '/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/chunkerflam.m', 176)" style="font-weight:bold">chunkerflam</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/chunkerflam.m',176,0)">line 176</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('helm_dprime', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/helm_dprime.m', 17)" style="font-weight:bold">helm_dprime</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/helm_dprime.m',17,0)">line 17</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('max_grad', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/max_grad.m', 6)" style="font-weight:bold">max_grad</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/max_grad.m',6,0)">line 6</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ellipse_loss', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/ellipse_loss.m', 25)" style="font-weight:bold">ellipse_loss</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/ellipse_loss.m',25,0)">line 25</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('optim.gd_grad_1d', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_grad_1d.m', 14)" style="font-weight:bold">optim.gd_grad_1d</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_grad_1d.m',14,0)">line 14</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('optim.gd_1d', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_1d.m', 49)" style="font-weight:bold">optim.gd_1d</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_1d.m',49,0)">line 49</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test_ellipse_gd', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/test_ellipse_gd.m', 24)" style="font-weight:bold">test_ellipse_gd</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/test_ellipse_gd.m',24,0)">line 24</a>)
] 
Time to find ymax_final: 5.82e-01
Finding eigenvalue ...
Time to find eigenvalue: 5.10e+01
Finding ymax_final ...
Time to find ymax_final: 7.25e-01
iter: 2, loss: -3.15e-01, grad: 6.26e-02, 2nd-deri: 1.36e-01 
Current weight 2.09005561849455
Finding eigenvalue ...
Time to find eigenvalue: 5.13e+01
Finding ymax_final ...
Time to find ymax_final: 7.53e-01
Finding eigenvalue ...
Time to find eigenvalue: 5.47e+01
Finding ymax_final ...
Time to find ymax_final: 6.62e-01
Finding eigenvalue ...
Time to find eigenvalue: 5.22e+01
Finding ymax_final ...
[Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.865964e-16.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('id', '/Users/zijianwang/Documents/MATLAB/FLAM/core/id.m', 120)" style="font-weight:bold">id</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/FLAM/core/id.m',120,0)">line 120</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chnk.flam.nproxy_square', '/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/+chnk/+flam/nproxy_square.m', 56)" style="font-weight:bold">chnk.flam.nproxy_square</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/+chnk/+flam/nproxy_square.m',56,0)">line 56</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerflam', '/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/chunkerflam.m', 176)" style="font-weight:bold">chunkerflam</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/chunkerflam.m',176,0)">line 176</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('helm_dprime', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/helm_dprime.m', 17)" style="font-weight:bold">helm_dprime</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/helm_dprime.m',17,0)">line 17</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('max_grad', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/max_grad.m', 6)" style="font-weight:bold">max_grad</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/max_grad.m',6,0)">line 6</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ellipse_loss', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/ellipse_loss.m', 25)" style="font-weight:bold">ellipse_loss</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/ellipse_loss.m',25,0)">line 25</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('optim.gd_grad_1d', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_grad_1d.m', 14)" style="font-weight:bold">optim.gd_grad_1d</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_grad_1d.m',14,0)">line 14</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('optim.gd_1d', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_1d.m', 49)" style="font-weight:bold">optim.gd_1d</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_1d.m',49,0)">line 49</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test_ellipse_gd', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/test_ellipse_gd.m', 24)" style="font-weight:bold">test_ellipse_gd</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/test_ellipse_gd.m',24,0)">line 24</a>)
] 
Time to find ymax_final: 7.08e-01
Finding eigenvalue ...
Time to find eigenvalue: 2.32e+02
Finding ymax_final ...
[Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  2.195310e-16.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('id', '/Users/zijianwang/Documents/MATLAB/FLAM/core/id.m', 120)" style="font-weight:bold">id</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/FLAM/core/id.m',120,0)">line 120</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chnk.flam.nproxy_square', '/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/+chnk/+flam/nproxy_square.m', 56)" style="font-weight:bold">chnk.flam.nproxy_square</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/+chnk/+flam/nproxy_square.m',56,0)">line 56</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerflam', '/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/chunkerflam.m', 176)" style="font-weight:bold">chunkerflam</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/chunkerflam.m',176,0)">line 176</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('helm_dprime', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/helm_dprime.m', 17)" style="font-weight:bold">helm_dprime</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/helm_dprime.m',17,0)">line 17</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('max_grad', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/max_grad.m', 6)" style="font-weight:bold">max_grad</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/max_grad.m',6,0)">line 6</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ellipse_loss', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/ellipse_loss.m', 25)" style="font-weight:bold">ellipse_loss</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/ellipse_loss.m',25,0)">line 25</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('optim.gd_1d', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_1d.m', 69)" style="font-weight:bold">optim.gd_1d</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_1d.m',69,0)">line 69</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test_ellipse_gd', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/test_ellipse_gd.m', 24)" style="font-weight:bold">test_ellipse_gd</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/test_ellipse_gd.m',24,0)">line 24</a>)
] 
Time to find ymax_final: 1.83e+00
iter: 3, loss: -3.33e-01, grad: 2.13e-02, 2nd-deri: 5.54e-02 
Current weight 2.47473168206614
Finding eigenvalue ...
Time to find eigenvalue: 2.25e+02
Finding ymax_final ...
Time to find ymax_final: 1.56e+00
Finding eigenvalue ...
Time to find eigenvalue: 2.32e+02
Finding ymax_final ...
Time to find ymax_final: 1.62e+00
Finding eigenvalue ...
Time to find eigenvalue: 1.98e+02
Finding ymax_final ...
Time to find ymax_final: 1.15e+00
Finding eigenvalue ...
Time to find eigenvalue: 1.71e+02
Finding ymax_final ...
Time to find ymax_final: 1.09e+00
iter: 4, loss: -3.38e-01, grad: 6.09e-03, 2nd-deri: 2.70e-02 
Current weight 2.70068122079556
Finding eigenvalue ...
Time to find eigenvalue: 1.72e+02
Finding ymax_final ...
[Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.721018e-16.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('id', '/Users/zijianwang/Documents/MATLAB/FLAM/core/id.m', 120)" style="font-weight:bold">id</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/FLAM/core/id.m',120,0)">line 120</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chnk.flam.nproxy_square', '/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/+chnk/+flam/nproxy_square.m', 56)" style="font-weight:bold">chnk.flam.nproxy_square</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/+chnk/+flam/nproxy_square.m',56,0)">line 56</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerflam', '/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/chunkerflam.m', 176)" style="font-weight:bold">chunkerflam</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/chunkie/chunkie/chunkerflam.m',176,0)">line 176</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('helm_dprime', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/helm_dprime.m', 17)" style="font-weight:bold">helm_dprime</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/helm_dprime.m',17,0)">line 17</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('max_grad', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/max_grad.m', 6)" style="font-weight:bold">max_grad</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/max_grad.m',6,0)">line 6</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ellipse_loss', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/ellipse_loss.m', 25)" style="font-weight:bold">ellipse_loss</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/ellipse_loss.m',25,0)">line 25</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('optim.gd_grad_1d', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_grad_1d.m', 12)" style="font-weight:bold">optim.gd_grad_1d</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_grad_1d.m',12,0)">line 12</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('optim.gd_1d', '/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_1d.m', 49)" style="font-weight:bold">optim.gd_1d</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/src/+optim/gd_1d.m',49,0)">line 49</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test_ellipse_gd', '/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/test_ellipse_gd.m', 24)" style="font-weight:bold">test_ellipse_gd</a> (<a href="matlab: opentoline('/Users/zijianwang/Documents/MATLAB/hot-spots/shape_optimization_rectangle/test_ellipse_gd.m',24,0)">line 24</a>)
] 
Time to find ymax_final: 1.13e+00
Finding eigenvalue ...
Time to find eigenvalue: 1.92e+02
Finding ymax_final ...
Time to find ymax_final: 1.26e+00
Finding eigenvalue ...
Time to find eigenvalue: 1.90e+02
Finding ymax_final ...
Time to find ymax_final: 9.84e-01
Finding eigenvalue ...
Time to find eigenvalue: 1.77e+02
Finding ymax_final ...
Time to find ymax_final: 1.12e+00
iter: 5, loss: -3.39e-01, grad: 1.05e-03, 2nd-deri: 1.82e-02 
Current weight 2.75825368889629
Finding eigenvalue ...
Time to find eigenvalue: 1.73e+02
Finding ymax_final ...
Time to find ymax_final: 1.16e+00
Finding eigenvalue ...
Time to find eigenvalue: 1.75e+02
Finding ymax_final ...
Time to find ymax_final: 1.27e+00
Finding eigenvalue ...
Time to find eigenvalue: 1.81e+02
Finding ymax_final ...
Time to find ymax_final: 1.05e+00
Finding eigenvalue ...
Time to find eigenvalue: 1.78e+02
Finding ymax_final ...
Time to find ymax_final: 1.14e+00
iter: 6, loss: -3.39e-01, grad: 5.22e-05, 2nd-deri: 1.63e-02 
Current weight 2.76145160186768
gradient descent converged after 7 steps
optimal weight: 2.76e+00 
Finding eigenvalue ...
Time to find eigenvalue: 1.82e+02
Finding ymax_final ...
Time to find ymax_final: 1.04e+00
optimal value: -3.39e-01 
