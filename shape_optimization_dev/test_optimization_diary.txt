
gd_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

             maxiter: 100
              report: 1
                 eps: 1.000000000000000e-06
              hspace: 1.000000000000000e-03
     line_search_eps: 1.000000000000000e-04
    line_search_beta: 0.500000000000000
              savefn: 'gd.mat'


loss_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    default_chebabs: [1 10]
           chnk_fun: @chnk_poly
         udnorm_ord: 'inf'
          unorm_ord: '2'

Polygon polygon with 4 vertices
Time to find eigenvalue: 5.56e+01; Time to compute 2-norm: 6.18e+00

chebabs =

   5.289913248920338   5.846746222490901

Computing 4 derivatives: 
Compuing dx1...
Time to find eigenvalue: 1.90e+01; Time to compute 2-norm: 6.11e+00

chebabs =

   5.292259763294246   5.849339738377851

Time to find eigenvalue: 1.86e+01; Time to compute 2-norm: 5.99e+00

chebabs =

   5.287571694546198   5.844158188708956

Compuing dx2...
Time to find eigenvalue: 1.72e+01; Time to compute 2-norm: 5.83e+00

chebabs =

   5.292259763281007   5.849339738363219

Time to find eigenvalue: 1.87e+01; Time to compute 2-norm: 5.79e+00

chebabs =

   5.287571694536499   5.844158188698236

Compuing dx3...
Time to find eigenvalue: 1.89e+01; Time to compute 2-norm: 5.87e+00

chebabs =

   5.292259763274463   5.849339738355986

Time to find eigenvalue: 2.08e+01; Time to compute 2-norm: 5.93e+00

chebabs =

   5.287571694513201   5.844158188672487

Compuing dx4...
Time to find eigenvalue: 1.85e+01; Time to compute 2-norm: 5.95e+00

chebabs =

   5.292259763290383   5.849339738373581

Time to find eigenvalue: 1.91e+01; Time to compute 2-norm: 5.90e+00

chebabs =

   5.287571694516605   5.844158188676247

Gradient computed!
Time to find eigenvalue: 2.08e+01; Time to compute 2-norm: 5.90e+00

chebabs =

   5.285753806807388   5.842148944366060

Time to find eigenvalue: 2.00e+01; Time to compute 2-norm: 6.14e+00

chebabs =

   5.294080059810561   5.851351645053779


max_step =

  1×0 empty <a href="matlab:helpPopup double" style="font-weight:bold">double</a> row vector

{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('mtimes')" style="font-weight:bold"> * </a>
Incorrect dimensions for matrix multiplication. Check that the number of
columns in the first matrix matches the number of rows in the second matrix. To
perform elementwise multiplication, use '.*'.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gd', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m', 123)" style="font-weight:bold">gd</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m',123,0)">line 123</a>)
        [isconvex, opt_next] = check_convex(opt - step * grad);

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 38)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',38,0)">line 38</a>)
[opt, gd_log] = gd(@loss, init_weight, gd_params, loss_params);

<a href="matlab:helpview('matlab','error_innerdim')" style="font-weight:bold">Related documentation</a>
} 
2 * [1 1]

ans =

     2     2

2 * [1 1]

ans =

     2     2

test

gd_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

             maxiter: 100
              report: 1
                 eps: 1.000000000000000e-06
              hspace: 1.000000000000000e-03
     line_search_eps: 1.000000000000000e-04
    line_search_beta: 0.500000000000000
              savefn: 'gd.mat'


loss_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    default_chebabs: [1 10]
           chnk_fun: @chnk_poly
         udnorm_ord: 'inf'
          unorm_ord: '2'

Polygon polygon with 4 vertices
Time to find eigenvalue: 5.53e+01; Time to compute 2-norm: 5.84e+00

chebabs =

   5.289913248924170   5.846746222495136

Computing 4 derivatives: 
Compuing dx1...
Time to find eigenvalue: 1.88e+01; Time to compute 2-norm: 5.92e+00

chebabs =

   5.292259763294087   5.849339738377676

Time to find eigenvalue: 1.86e+01; Time to compute 2-norm: 5.89e+00

chebabs =

   5.287571694545656   5.844158188708358

Compuing dx2...
Time to find eigenvalue: 1.73e+01; Time to compute 2-norm: 5.79e+00

chebabs =

   5.292259763280514   5.849339738362675

Time to find eigenvalue: 1.87e+01; Time to compute 2-norm: 5.76e+00

chebabs =

   5.287571694536044   5.844158188697733

Compuing dx3...
Time to find eigenvalue: 1.90e+01; Time to compute 2-norm: 5.82e+00

chebabs =

   5.292259763272927   5.849339738354288

Time to find eigenvalue: 2.08e+01; Time to compute 2-norm: 5.87e+00

chebabs =

   5.287571694521937   5.844158188682140

Compuing dx4...
Time to find eigenvalue: 1.85e+01; Time to compute 2-norm: 5.94e+00

chebabs =

   5.292259763290359   5.849339738373556

Time to find eigenvalue: 1.91e+01; Time to compute 2-norm: 5.95e+00

chebabs =

   5.287571694515828   5.844158188675388

Gradient computed!
Time to find eigenvalue: 2.21e+01; Time to compute 2-norm: 6.18e+00

chebabs =

   5.285751516810397   5.842146413316756

Time to find eigenvalue: 1.88e+01; Time to compute 2-norm: 5.90e+00

chebabs =

   5.294082350938466   5.851354177353042


max_step =

  1×0 empty <a href="matlab:helpPopup double" style="font-weight:bold">double</a> row vector


step_shape =

     1     0


grad_shape =

     1     4


opt_shape =

     1     4

{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('times')" style="font-weight:bold"> .* </a>
Arrays have incompatible sizes for this operation.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gd', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m', 126)" style="font-weight:bold">gd</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m',126,0)">line 126</a>)
        [isconvex, opt_next] = check_convex(opt - step .* grad);

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 38)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',38,0)">line 38</a>)
[opt, gd_log] = gd(@loss, init_weight, gd_params, loss_params);

<a href="matlab:helpview('matlab','error_sizeDimensionsMustMatch')" style="font-weight:bold">Related documentation</a>
} 
test

gd_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

             maxiter: 100
              report: 1
                 eps: 1.000000000000000e-06
              hspace: 1.000000000000000e-03
     line_search_eps: 1.000000000000000e-04
    line_search_beta: 0.500000000000000
              savefn: 'gd.mat'


loss_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    default_chebabs: [1 10]
           chnk_fun: @chnk_poly
         udnorm_ord: 'inf'
          unorm_ord: '2'

Polygon polygon with 4 vertices
Time to find eigenvalue: 5.63e+01; Time to compute 2-norm: 5.83e+00

chebabs =

   5.289913248924148   5.846746222495113

Computing 4 derivatives: 
Compuing dx1...
Time to find eigenvalue: 1.90e+01; Time to compute 2-norm: 5.97e+00

chebabs =

   5.292259763294089   5.849339738377678

Time to find eigenvalue: 1.89e+01; Time to compute 2-norm: 5.91e+00

chebabs =

   5.287571694545838   5.844158188708558

Compuing dx2...
Time to find eigenvalue: 1.77e+01; Time to compute 2-norm: 5.84e+00

chebabs =

   5.292259763280167   5.849339738362290

Time to find eigenvalue: 1.93e+01; Time to compute 2-norm: 5.88e+00

chebabs =

   5.287571694535996   5.844158188697679

Compuing dx3...
Time to find eigenvalue: 1.89e+01; [Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.840839e-16.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('id', 'C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m', 120)" style="font-weight:bold">id</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m',120,0)">line 120</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chnk.flam.nproxy_square', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\+chnk\+flam\nproxy_square.m', 56)" style="font-weight:bold">chnk.flam.nproxy_square</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\+chnk\+flam\nproxy_square.m',56,0)">line 56</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerflam', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerflam.m', 176)" style="font-weight:bold">chunkerflam</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerflam.m',176,0)">line 176</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('helm_dprime', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\helm_dprime.m', 17)" style="font-weight:bold">helm_dprime</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\helm_dprime.m',17,0)">line 17</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ud_norm', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\ud_norm.m', 7)" style="font-weight:bold">ud_norm</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\ud_norm.m',7,0)">line 7</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('loss', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m', 42)" style="font-weight:bold">loss</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m',42,0)">line 42</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gd', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m', 76)" style="font-weight:bold">gd</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m',76,0)">line 76</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 38)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',38,0)">line 38</a>)
] 
Time to compute 2-norm: 5.84e+00

chebabs =

   5.292259763273037   5.849339738354409

Time to find eigenvalue: 2.08e+01; Time to compute 2-norm: 5.85e+00

chebabs =

   5.287571694515863   5.844158188675427

Compuing dx4...
Time to find eigenvalue: 1.85e+01; Time to compute 2-norm: 5.95e+00

chebabs =

   5.292259763290083   5.849339738373251

Time to find eigenvalue: 1.92e+01; Time to compute 2-norm: 5.93e+00

chebabs =

   5.287571694516123   5.844158188675715

Gradient computed!
Time to find eigenvalue: 1.82e+01; Time to compute 2-norm: 5.81e+00

chebabs =

   5.285751042292446   5.842145888849547

Time to find eigenvalue: 2.12e+01; Time to compute 2-norm: 5.93e+00

chebabs =

   5.294082829924069   5.851354706758182


num_directions_inward =

     0

{Unrecognized function or variable 'max_step'.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gd', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m', 125)" style="font-weight:bold">gd</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m',125,0)">line 125</a>)
        max_step

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 38)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',38,0)">line 38</a>)
[opt, gd_log] = gd(@loss, init_weight, gd_params, loss_params);
} 
test

gd_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

             maxiter: 100
              report: 1
                 eps: 1.000000000000000e-06
              hspace: 1.000000000000000e-03
     line_search_eps: 1.000000000000000e-04
    line_search_beta: 0.500000000000000
              savefn: 'gd.mat'


loss_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    default_chebabs: [1 10]
           chnk_fun: @chnk_poly
         udnorm_ord: 'inf'
          unorm_ord: '2'

Polygon polygon with 4 vertices
Time to find eigenvalue: 5.54e+01; Time to compute 2-norm: 5.93e+00

chebabs =

   5.289913248919807   5.846746222490313

Computing 4 derivatives: 
Compuing dx1...
Time to find eigenvalue: 1.88e+01; [Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  2.183758e-16.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('id', 'C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m', 120)" style="font-weight:bold">id</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m',120,0)">line 120</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chnk.flam.nproxy_square', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\+chnk\+flam\nproxy_square.m', 56)" style="font-weight:bold">chnk.flam.nproxy_square</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\+chnk\+flam\nproxy_square.m',56,0)">line 56</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerflam', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerflam.m', 176)" style="font-weight:bold">chunkerflam</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerflam.m',176,0)">line 176</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('helm_dprime', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\helm_dprime.m', 17)" style="font-weight:bold">helm_dprime</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\helm_dprime.m',17,0)">line 17</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ud_norm', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\ud_norm.m', 7)" style="font-weight:bold">ud_norm</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\ud_norm.m',7,0)">line 7</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('loss', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m', 42)" style="font-weight:bold">loss</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m',42,0)">line 42</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gd', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m', 76)" style="font-weight:bold">gd</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m',76,0)">line 76</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 38)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',38,0)">line 38</a>)
] 
Time to compute 2-norm: 5.92e+00

chebabs =

   5.292259763293812   5.849339738377372

Time to find eigenvalue: 1.86e+01; Time to compute 2-norm: 5.93e+00

chebabs =

   5.287571694546157   5.844158188708912

Compuing dx2...
Time to find eigenvalue: 1.73e+01; Time to compute 2-norm: 5.79e+00

chebabs =

   5.292259763280341   5.849339738362482

Time to find eigenvalue: 1.87e+01; Time to compute 2-norm: 5.78e+00

chebabs =

   5.287571694536047   5.844158188697738

Compuing dx3...
Time to find eigenvalue: 1.90e+01; Time to compute 2-norm: 5.84e+00

chebabs =

   5.292259763273422   5.849339738354835

Time to find eigenvalue: 2.07e+01; Time to compute 2-norm: 5.90e+00

chebabs =

   5.287571694512549   5.844158188671765

Compuing dx4...
Time to find eigenvalue: 1.89e+01; Time to compute 2-norm: 5.99e+00

chebabs =

   5.292259763290139   5.849339738373312

Time to find eigenvalue: 1.92e+01; Time to compute 2-norm: 5.88e+00

chebabs =

   5.287571694515826   5.844158188675387

Gradient computed!
Time to find eigenvalue: 2.08e+01; Time to compute 2-norm: 5.95e+00

chebabs =

   5.285752060327538   5.842147014046227

Time to find eigenvalue: 2.20e+01; Time to compute 2-norm: 6.13e+00

chebabs =

   5.294081807351395   5.851353576546279


num_directions_inward =

     0


step =

   0.027181845080443

Time to find eigenvalue: 2.04e+01; Time to compute 2-norm: 5.87e+00

chebabs =

   5.289918789426174   5.846752346207877

Time to find eigenvalue: 1.85e+01; Time to compute 2-norm: 5.76e+00

chebabs =

   5.289916019198739   5.846749284377554

Time to find eigenvalue: 1.88e+01; Time to compute 2-norm: 5.88e+00

chebabs =

   5.289914634060340   5.846747753435112

Time to find eigenvalue: 1.99e+01; [Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.487055e-16.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('id', 'C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m', 120)" style="font-weight:bold">id</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m',120,0)">line 120</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chnk.flam.nproxy_square', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\+chnk\+flam\nproxy_square.m', 56)" style="font-weight:bold">chnk.flam.nproxy_square</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\+chnk\+flam\nproxy_square.m',56,0)">line 56</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerflam', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerflam.m', 176)" style="font-weight:bold">chunkerflam</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerflam.m',176,0)">line 176</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('helm_dprime', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\helm_dprime.m', 17)" style="font-weight:bold">helm_dprime</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\helm_dprime.m',17,0)">line 17</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ud_norm', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\ud_norm.m', 7)" style="font-weight:bold">ud_norm</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\ud_norm.m',7,0)">line 7</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('loss', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m', 42)" style="font-weight:bold">loss</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m',42,0)">line 42</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gd', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m', 139)" style="font-weight:bold">gd</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m',139,0)">line 139</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 38)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',38,0)">line 38</a>)
] 
Time to compute 2-norm: 5.69e+00

chebabs =

   5.289913941543196   5.846746988021428

Time to find eigenvalue: 1.88e+01; Time to compute 2-norm: 5.92e+00

chebabs =

   5.289913595280488   5.846746605310013

Time to find eigenvalue: 2.05e+01; Time to compute 2-norm: 5.72e+00

chebabs =

   5.289913422092591   5.846746413891811

Time to find eigenvalue: 2.15e+01; Time to compute 2-norm: 6.16e+00

chebabs =

   5.289913335553212   5.846746318243024

Time to find eigenvalue: 2.11e+01; Time to compute 2-norm: 6.11e+00

chebabs =

   5.289913292257769   5.846746270390165

Time to find eigenvalue: 1.92e+01; Time to compute 2-norm: 6.03e+00

chebabs =

   5.289913270631047   5.846746246486948

Time to find eigenvalue: 2.01e+01; Time to compute 2-norm: 5.77e+00

chebabs =

   5.289913259796320   5.846746234511723

Line search did not convergeSaving log file...
iter: 1, loss: -3.18e-01, grad: 4.89e-05, 2nd-deri: 3.68e+01, time: 5.81e+02
Current weight [0.564189582745803 0.564189582736546 0.564189582731493 0.564189581360718]
Current gradient [1.51056823161078e-05 1.52800486985516e-05 1.53752105769289e-05 4.11952826018247e-05]
gradient descent did not converge after 2 steps
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
{Not enough input arguments.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('loss', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m', 18)" style="font-weight:bold">loss</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m',18,0)">line 18</a>)
    default_chebabs = loss_params.default_chebabs;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 40)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',40,0)">line 40</a>)
fprintf('optimal value: %5.2e \n', fun(opt));
} 
test

gd_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

             maxiter: 100
              report: 1
                 eps: 1.000000000000000e-06
              hspace: 1.000000000000000e-03
     line_search_eps: 1.000000000000000e-04
    line_search_beta: 0.500000000000000
              savefn: 'gd.mat'


loss_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    default_chebabs: [1 10]
           chnk_fun: @chnk_poly
         udnorm_ord: 'inf'
          unorm_ord: '2'

Polygon polygon with 8 vertices
Time to find eigenvalue: 1.21e+02; Time to compute 2-norm: 7.95e+00

chebabs =

   4.287988382372018   4.739355580516441

Computing 8 derivatives: 
Compuing dx1...
Time to find eigenvalue: 3.57e+01; Time to compute 2-norm: 8.01e+00

chebabs =

   4.288940122158065   4.740407503437861

Time to find eigenvalue: 3.59e+01; Time to compute 2-norm: 7.59e+00

chebabs =

   4.287040051800916   4.738307425674697

Compuing dx2...
Time to find eigenvalue: 3.47e+01; Time to compute 2-norm: 7.54e+00

chebabs =

   4.288940122159705   4.740407503439673

Time to find eigenvalue: 4.20e+01; Time to compute 2-norm: 1.08e+01

chebabs =

   4.287040051846096   4.738307425724633

Compuing dx3...
Time to find eigenvalue: 4.43e+01; Time to compute 2-norm: 8.51e+00

chebabs =

   4.288940122194298   4.740407503477908

Time to find eigenvalue: 4.16e+01; Time to compute 2-norm: 8.54e+00

chebabs =

   4.287040051822193   4.738307425698214

Compuing dx4...
Time to find eigenvalue: 3.94e+01; Time to compute 2-norm: 8.13e+00

chebabs =

   4.288940122199313   4.740407503483453

Time to find eigenvalue: 3.87e+01; Time to compute 2-norm: 8.02e+00

chebabs =

   4.287040051815312   4.738307425690609

Compuing dx5...
Time to find eigenvalue: 3.75e+01; Time to compute 2-norm: 7.88e+00

chebabs =

   4.288940122156938   4.740407503436617

Time to find eigenvalue: 3.76e+01; Time to compute 2-norm: 7.73e+00

chebabs =

   4.287040051819739   4.738307425695501

Compuing dx6...
Time to find eigenvalue: 3.79e+01; Time to compute 2-norm: 7.82e+00

chebabs =

   4.288940122155615   4.740407503435153

Time to find eigenvalue: 3.88e+01; Time to compute 2-norm: 7.75e+00

chebabs =

   4.287040051829763   4.738307425706580

Compuing dx7...
Time to find eigenvalue: 3.56e+01; Time to compute 2-norm: 7.72e+00

chebabs =

   4.288940122133593   4.740407503410814

Time to find eigenvalue: 3.77e+01; Time to compute 2-norm: 7.71e+00

chebabs =

   4.287040051809210   4.738307425683864

Compuing dx8...
Time to find eigenvalue: 3.57e+01; [Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.727053e-16.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('id', 'C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m', 120)" style="font-weight:bold">id</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m',120,0)">line 120</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ifmm', 'C:\Users\charl\Documents\MATLAB\lib\FLAM\ifmm\ifmm.m', 351)" style="font-weight:bold">ifmm</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\FLAM\ifmm\ifmm.m',351,0)">line 351</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerkerneval>chunkerkerneval_smooth', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerkerneval.m', 209)" style="font-weight:bold">chunkerkerneval>chunkerkerneval_smooth</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerkerneval.m',209,0)">line 209</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerkerneval', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerkerneval.m', 95)" style="font-weight:bold">chunkerkerneval</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerkerneval.m',95,0)">line 95</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('u_norm', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\u_norm.m', 22)" style="font-weight:bold">u_norm</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\u_norm.m',22,0)">line 22</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('loss', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m', 44)" style="font-weight:bold">loss</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m',44,0)">line 44</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gd', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m', 76)" style="font-weight:bold">gd</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m',76,0)">line 76</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 38)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',38,0)">line 38</a>)
] 
Time to compute 2-norm: 7.63e+00

chebabs =

   4.288940122175302   4.740407503456914

Time to find eigenvalue: 3.45e+01; Time to compute 2-norm: 7.56e+00

chebabs =

   4.287040051832412   4.738307425709508

Gradient computed!
Time to find eigenvalue: 3.92e+01; Time to compute 2-norm: 8.20e+00

chebabs =

   4.286691162360827   4.737921811030389

Time to find eigenvalue: 4.12e+01; Time to compute 2-norm: 7.96e+00

chebabs =

   4.289287867974317   4.740791854076877

[Warning: Negative second derivative -9.08e+01] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gd', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m', 107)" style="font-weight:bold">gd</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m',107,0)">line 107</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 38)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',38,0)">line 38</a>)] 

num_directions_inward =

     3


step =

     1

Time to find eigenvalue: 2.03e+01; Time to compute 2-norm: 8.05e+00

chebabs =

   4.530435666854214   5.007323631786238

Time to find eigenvalue: 4.06e+01; Time to compute 2-norm: 8.13e+00

chebabs =

   4.400288162167957   4.863476389764584

Time to find eigenvalue: 4.03e+01; Time to compute 2-norm: 7.95e+00

chebabs =

   4.342102344491305   4.799165749174602

Time to find eigenvalue: 3.98e+01; Time to compute 2-norm: 8.04e+00

chebabs =

   4.314560197923296   4.768724429283644

Time to find eigenvalue: 4.09e+01; Time to compute 2-norm: 8.25e+00

chebabs =

   4.301155938712097   4.753909195418633

Time to find eigenvalue: 4.00e+01; Time to compute 2-norm: 7.97e+00

chebabs =

   4.294542937732145   4.746600089072371

Time to find eigenvalue: 3.64e+01; Time to compute 2-norm: 7.60e+00

chebabs =

   4.291258399881727   4.742969810395593

Time to find eigenvalue: 3.76e+01; Time to compute 2-norm: 7.86e+00

chebabs =

   4.289621581744285   4.741160695612106

Time to find eigenvalue: 3.73e+01; Time to compute 2-norm: 7.78e+00

chebabs =

   4.288804530398647   4.740257638861662

Time to find eigenvalue: 3.71e+01; Time to compute 2-norm: 7.78e+00

chebabs =

   4.288396343601416   4.739806485033144

Time to find eigenvalue: 3.66e+01; Time to compute 2-norm: 7.71e+00

chebabs =

   4.288192334770406   4.739581001588343

Time to find eigenvalue: 4.09e+01; Time to compute 2-norm: 7.95e+00

chebabs =

   4.288090351591596   4.739468283338080

Time to find eigenvalue: 4.01e+01; Time to compute 2-norm: 8.02e+00

chebabs =

   4.288039365273097   4.739411930038687

Time to find eigenvalue: 3.85e+01; Time to compute 2-norm: 8.11e+00

chebabs =

   4.288013873393230   4.739383754803044

Time to find eigenvalue: 3.83e+01; Time to compute 2-norm: 7.92e+00

chebabs =

   4.288001127752613   4.739369667516046

Line search did not convergeSaving log file...
iter: 1, loss: -2.77e-01, grad: 1.61e-01, 2nd-deri: -9.08e+01, time: 1.68e+03
Current weight [0.564186220690554 0.564191750608443 0.564186220844913 0.564184667357956 0.564184667380145 0.564186220991919 0.564191754141843 0.564191750660861]
Current gradient [0.0550970523949534 -0.0355051222933611 0.0550945233762923 0.0805468536869136 0.080546490150879 0.0550921148333716 -0.0355630135162044 -0.0355059811026348]
gradient descent did not converge after 2 steps
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
{Not enough input arguments.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('loss', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m', 18)" style="font-weight:bold">loss</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m',18,0)">line 18</a>)
    default_chebabs = loss_params.default_chebabs;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 40)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',40,0)">line 40</a>)
fprintf('optimal value: %5.2e \n', fun(opt));
} 
[0.564186220690554 0.564191750608443 0.564186220844913 0.564184667357956 0.564184667380145 0.564186220991919 0.564191754141843 0.564191750660861]

ans =

  Columns 1 through 5

   0.564186220690554   0.564191750608443   0.564186220844913   0.564184667357956   0.564184667380145

  Columns 6 through 8

   0.564186220991919   0.564191754141843   0.564191750660861

ans

ans =

  Columns 1 through 5

   0.564186220690554   0.564191750608443   0.564186220844913   0.564184667357956   0.564184667380145

  Columns 6 through 8

   0.564186220991919   0.564191754141843   0.564191750660861

plot(chnk_poly(ans))
test

gd_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

             maxiter: 100
              report: 1
                 eps: 1.000000000000000e-06
              hspace: 1.000000000000000e-03
     line_search_eps: 1.000000000000000e-04
    line_search_beta: 0.500000000000000
              savefn: 'gd.mat'


loss_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    default_chebabs: [1 10]
           chnk_fun: @chnk_poly
         udnorm_ord: 'inf'
          unorm_ord: '2'

Polygon polygon with 4 vertices
Time to find eigenvalue: 5.62e+01; Time to compute 2-norm: 6.27e+00

chebabs =

   5.289913248925201   5.846746222496275

Computing 4 derivatives: 
Compuing dx1...
Time to find eigenvalue: 1.94e+01; Time to compute 2-norm: 6.10e+00

chebabs =

   5.292259763294089   5.849339738377678

Time to find eigenvalue: 1.90e+01; Time to compute 2-norm: 6.02e+00

chebabs =

   5.287571694545882   5.844158188708606

Compuing dx2...
Time to find eigenvalue: 1.74e+01; Time to compute 2-norm: 5.88e+00

chebabs =

   5.292259763280167   5.849339738362290

Time to find eigenvalue: 1.88e+01; Time to compute 2-norm: 5.85e+00

chebabs =

   5.287571694536090   5.844158188697784

Compuing dx3...
Time to find eigenvalue: 1.98e+01; Time to compute 2-norm: 5.96e+00

chebabs =

   5.292259763274307   5.849339738355814

Time to find eigenvalue: 2.11e+01; Time to compute 2-norm: 6.01e+00

chebabs =

   5.287571694513201   5.844158188672486

Compuing dx4...
Time to find eigenvalue: 1.91e+01; Time to compute 2-norm: 6.03e+00

chebabs =

   5.292259763290365   5.849339738373561

Time to find eigenvalue: 1.93e+01; Time to compute 2-norm: 5.99e+00

chebabs =

   5.287571694516064   5.844158188675650

Gradient computed!
Time to find eigenvalue: 1.90e+01; Time to compute 2-norm: 6.01e+00

chebabs =

   5.285752082774615   5.842147038856154

Time to find eigenvalue: 1.84e+01; Time to compute 2-norm: 5.90e+00

chebabs =

   5.294081784871155   5.851353551699699


num_directions_inward =

     4


step =

   0.027179555907216

Time to find eigenvalue: 1.74e+01; [Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.708927e-16.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('id', 'C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m', 120)" style="font-weight:bold">id</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m',120,0)">line 120</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chnk.flam.nproxy_square', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\+chnk\+flam\nproxy_square.m', 56)" style="font-weight:bold">chnk.flam.nproxy_square</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\+chnk\+flam\nproxy_square.m',56,0)">line 56</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerflam', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerflam.m', 176)" style="font-weight:bold">chunkerflam</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerflam.m',176,0)">line 176</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('helm_dprime', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\helm_dprime.m', 17)" style="font-weight:bold">helm_dprime</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\helm_dprime.m',17,0)">line 17</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ud_norm', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\ud_norm.m', 7)" style="font-weight:bold">ud_norm</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\ud_norm.m',7,0)">line 7</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('loss', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m', 42)" style="font-weight:bold">loss</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m',42,0)">line 42</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gd', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m', 128)" style="font-weight:bold">gd</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m',128,0)">line 128</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 38)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',38,0)">line 38</a>)
] 
Time to compute 2-norm: 5.85e+00

chebabs =

   5.289918788957600   5.846752345689978


step =

   0.027179555907216

Time to find eigenvalue: 2.08e+01; [Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.319093e-16.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('id', 'C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m', 120)" style="font-weight:bold">id</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m',120,0)">line 120</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chnk.flam.nproxy_square', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\+chnk\+flam\nproxy_square.m', 56)" style="font-weight:bold">chnk.flam.nproxy_square</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\+chnk\+flam\nproxy_square.m',56,0)">line 56</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerflam', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerflam.m', 176)" style="font-weight:bold">chunkerflam</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerflam.m',176,0)">line 176</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('helm_dprime', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\helm_dprime.m', 17)" style="font-weight:bold">helm_dprime</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\helm_dprime.m',17,0)">line 17</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ud_norm', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\ud_norm.m', 7)" style="font-weight:bold">ud_norm</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\ud_norm.m',7,0)">line 7</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('loss', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m', 42)" style="font-weight:bold">loss</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m',42,0)">line 42</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gd', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m', 139)" style="font-weight:bold">gd</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m',139,0)">line 139</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 38)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',38,0)">line 38</a>)
] 
Time to compute 2-norm: 6.05e+00

chebabs =

   5.289916018944552   5.846749284096610

Time to find eigenvalue: 1.99e+01; Time to compute 2-norm: 6.01e+00

chebabs =

   5.289914633968896   5.846747753334045

Time to find eigenvalue: 1.87e+01; Time to compute 2-norm: 5.84e+00

chebabs =

   5.289913941475910   5.846746987947060

Time to find eigenvalue: 1.94e+01; Time to compute 2-norm: 5.89e+00

chebabs =

   5.289913595252232   5.846746605278783

Time to find eigenvalue: 1.94e+01; Time to compute 2-norm: 6.12e+00

chebabs =

   5.289913422107028   5.846746413907769

Time to find eigenvalue: 2.30e+01; Time to compute 2-norm: 6.61e+00

chebabs =

   5.289913335538976   5.846746318227289

Time to find eigenvalue: 2.04e+01; Time to compute 2-norm: 5.90e+00

chebabs =

   5.289913292274949   5.846746270409153

Time to find eigenvalue: 1.77e+01; Time to compute 2-norm: 5.86e+00

chebabs =

   5.289913270621962   5.846746246476905

Time to find eigenvalue: 2.00e+01; Time to compute 2-norm: 6.02e+00

chebabs =

   5.289913259750061   5.846746234460594

Line search did not convergeSaving log file...
iter: 1, loss: -3.18e-01, grad: 4.89e-05, 2nd-deri: 3.68e+01, time: 5.80e+02
Current weight [0.564189582745935 0.564189582736585 0.564189582731544 0.564189581360869]
Current gradient [1.51044517449073e-05 1.52805936237677e-05 1.53755529974653e-05 4.11959018842278e-05]
gradient descent did not converge after 2 steps
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
{Not enough input arguments.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('loss', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m', 18)" style="font-weight:bold">loss</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m',18,0)">line 18</a>)
    default_chebabs = loss_params.default_chebabs;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 40)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',40,0)">line 40</a>)
fprintf('optimal value: %5.2e \n', fun(opt));
} 
test

gd_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

             maxiter: 100
              report: 1
                 eps: 1.000000000000000e-06
              hspace: 1.000000000000000e-03
     line_search_eps: 1.000000000000000e-04
    line_search_beta: 0.500000000000000
              savefn: 'gd.mat'


loss_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    default_chebabs: [1 10]
           chnk_fun: @chnk_poly
         udnorm_ord: 'inf'
          unorm_ord: '2'

Polygon polygon with 8 vertices
Time to find eigenvalue: 1.23e+02; Time to compute 2-norm: 7.95e+00

chebabs =

   4.287988382389180   4.739355580535410

Computing 8 derivatives: 
Compuing dx1...
Time to find eigenvalue: 3.52e+01; Time to compute 2-norm: 7.69e+00

chebabs =

   4.288940122148520   4.740407503427313

Time to find eigenvalue: 3.54e+01; Time to compute 2-norm: 7.59e+00

chebabs =

   4.287040051802699   4.738307425676669

Compuing dx2...
Time to find eigenvalue: 3.45e+01; Time to compute 2-norm: 7.58e+00

chebabs =

   4.288940122161087   4.740407503441201

Time to find eigenvalue: 3.90e+01; Time to compute 2-norm: 8.09e+00

chebabs =

   4.287040051850060   4.738307425729015

Compuing dx3...
Time to find eigenvalue: 4.00e+01; Time to compute 2-norm: 7.96e+00

chebabs =

   4.288940122182177   4.740407503464512

Time to find eigenvalue: 3.84e+01; Time to compute 2-norm: 8.10e+00

chebabs =

   4.287040051816486   4.738307425691906

Compuing dx4...
Time to find eigenvalue: 3.76e+01; Time to compute 2-norm: 7.90e+00

chebabs =

   4.288940122204323   4.740407503488989

Time to find eigenvalue: 3.87e+01; Time to compute 2-norm: 7.89e+00

chebabs =

   4.287040051826150   4.738307425702587

Compuing dx5...
Time to find eigenvalue: 3.75e+01; [Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  2.010598e-16.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('id', 'C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m', 120)" style="font-weight:bold">id</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m',120,0)">line 120</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chnk.flam.nproxy_square', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\+chnk\+flam\nproxy_square.m', 56)" style="font-weight:bold">chnk.flam.nproxy_square</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\+chnk\+flam\nproxy_square.m',56,0)">line 56</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerflam', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerflam.m', 176)" style="font-weight:bold">chunkerflam</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerflam.m',176,0)">line 176</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('helm_dprime', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\helm_dprime.m', 17)" style="font-weight:bold">helm_dprime</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\helm_dprime.m',17,0)">line 17</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ud_norm', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\ud_norm.m', 7)" style="font-weight:bold">ud_norm</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\ud_norm.m',7,0)">line 7</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('loss', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m', 42)" style="font-weight:bold">loss</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m',42,0)">line 42</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gd', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m', 76)" style="font-weight:bold">gd</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m',76,0)">line 76</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 38)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',38,0)">line 38</a>)
] 
Time to compute 2-norm: 7.80e+00

chebabs =

   4.288940122158118   4.740407503437919

Time to find eigenvalue: 3.72e+01; Time to compute 2-norm: 7.89e+00

chebabs =

   4.287040051822858   4.738307425698949

Compuing dx6...
Time to find eigenvalue: 3.78e+01; Time to compute 2-norm: 7.89e+00

chebabs =

   4.288940122163201   4.740407503443539

Time to find eigenvalue: 3.74e+01; Time to compute 2-norm: 7.86e+00

chebabs =

   4.287040051821451   4.738307425697394

Compuing dx7...
Time to find eigenvalue: 3.38e+01; Time to compute 2-norm: 7.42e+00

chebabs =

   4.288940122133813   4.740407503411057

Time to find eigenvalue: 3.69e+01; Time to compute 2-norm: 7.93e+00

chebabs =

   4.287040051812880   4.738307425687921

Compuing dx8...
Time to find eigenvalue: 3.57e+01; [Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.825174e-16.] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('id', 'C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m', 120)" style="font-weight:bold">id</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\FLAM\core\id.m',120,0)">line 120</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('ifmm', 'C:\Users\charl\Documents\MATLAB\lib\FLAM\ifmm\ifmm.m', 351)" style="font-weight:bold">ifmm</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\FLAM\ifmm\ifmm.m',351,0)">line 351</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerkerneval>chunkerkerneval_smooth', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerkerneval.m', 209)" style="font-weight:bold">chunkerkerneval>chunkerkerneval_smooth</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerkerneval.m',209,0)">line 209</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('chunkerkerneval', 'C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerkerneval.m', 95)" style="font-weight:bold">chunkerkerneval</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\lib\chunkie\chunkie\chunkerkerneval.m',95,0)">line 95</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('u_norm', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\u_norm.m', 22)" style="font-weight:bold">u_norm</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\u_norm.m',22,0)">line 22</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('loss', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m', 44)" style="font-weight:bold">loss</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m',44,0)">line 44</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gd', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m', 76)" style="font-weight:bold">gd</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m',76,0)">line 76</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 38)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',38,0)">line 38</a>)
] 
Time to compute 2-norm: 7.70e+00

chebabs =

   4.288940122178053   4.740407503459954

Time to find eigenvalue: 3.47e+01; Time to compute 2-norm: 7.63e+00

chebabs =

   4.287040051828926   4.738307425705656

Gradient computed!
Time to find eigenvalue: 4.27e+01; Time to compute 2-norm: 8.23e+00

chebabs =

   4.286691158989367   4.737921807304037

Time to find eigenvalue: 3.82e+01; Time to compute 2-norm: 7.82e+00

chebabs =

   4.289287871276034   4.740791857726144

[Warning: Negative second derivative -9.08e+01] 
[> In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gd', 'C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m', 107)" style="font-weight:bold">gd</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\src\gd.m',107,0)">line 107</a>)
In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 38)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',38,0)">line 38</a>)] 

num_directions_inward =

     5


step =

     1

Time to find eigenvalue: 2.20e+01; Time to compute 2-norm: 7.94e+00

chebabs =

   4.530434360626989   5.007322188061410

Some statistics before line search
step =

     1


fdd =

 -90.765350825527946


grad =

  Columns 1 through 5

   0.055097085178063  -0.035503934210368   0.055094346110091   0.080546908633461   0.080546504651280

  Columns 6 through 8

   0.055090260634327  -0.035562999804867  -0.035505946194003


opt =

  Columns 1 through 5

   0.564189583547756   0.564189583547756   0.564189583547756   0.564189583547756   0.564189583547756

  Columns 6 through 8

   0.564189583547756   0.564189583547756   0.564189583547756

Time to find eigenvalue: 3.67e+01; Time to compute 2-norm: 7.81e+00

chebabs =

   4.400287681894664   4.863475858936209

Time to find eigenvalue: 4.31e+01; Time to compute 2-norm: 8.00e+00

chebabs =

   4.342102143448646   4.799165526969556

Time to find eigenvalue: 3.62e+01; Time to compute 2-norm: 7.73e+00

chebabs =

   4.314560106739415   4.768724328501459

Time to find eigenvalue: 3.93e+01; Time to compute 2-norm: 8.16e+00

chebabs =

   4.301155895345035   4.753909147486619

Time to find eigenvalue: 3.74e+01; Time to compute 2-norm: 7.63e+00

chebabs =

   4.294542916626329   4.746600065744890

Time to find eigenvalue: 4.06e+01; Time to compute 2-norm: 8.09e+00

chebabs =

   4.291258389381507   4.742969798790087

Time to find eigenvalue: 4.10e+01; Time to compute 2-norm: 8.01e+00

chebabs =

   4.289621576572510   4.741160689895932

Time to find eigenvalue: 4.11e+01; Time to compute 2-norm: 8.34e+00

chebabs =

   4.288804527870504   4.740257636067399

Time to find eigenvalue: 4.17e+01; Time to compute 2-norm: 8.50e+00

chebabs =

   4.288396342366662   4.739806483668415

Time to find eigenvalue: 4.09e+01; Time to compute 2-norm: 8.12e+00

chebabs =

   4.288192334124703   4.739581000874671

Time to find eigenvalue: 3.90e+01; Time to compute 2-norm: 7.99e+00

chebabs =

   4.288090351199460   4.739468282904666

Time to find eigenvalue: 4.19e+01; Time to compute 2-norm: 7.93e+00

chebabs =

   4.288039365090478   4.739411929836844

Time to find eigenvalue: 3.92e+01; Time to compute 2-norm: 8.65e+00

chebabs =

   4.288013873270355   4.739383754667235

Time to find eigenvalue: 4.14e+01; Time to compute 2-norm: 8.09e+00

chebabs =

   4.288001127744933   4.739369667507558

Line search did not convergeSaving log file...
iter: 1, loss: -2.77e-01, grad: 1.61e-01, 2nd-deri: -9.08e+01, time: 1.68e+03
Current weight [0.564186220688554 0.564191750535928 0.564186220855733 0.564184667354602 0.56418466737926 0.564186221105091 0.564191754141006 0.56419175065873]
Current gradient [0.055097085178063 -0.035503934210368 0.0550943461100906 0.0805469086334609 0.0805465046512799 0.0550902606343273 -0.0355629998048668 -0.0355059461940033]
gradient descent did not converge after 2 steps
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
optimal weight: 5.64e-01 
{Not enough input arguments.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('loss', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m', 18)" style="font-weight:bold">loss</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\loss.m',18,0)">line 18</a>)
    default_chebabs = loss_params.default_chebabs;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('test', 'C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m', 40)" style="font-weight:bold">test</a> (<a href="matlab: opentoline('C:\Users\charl\Documents\MATLAB\hot-spots\shape_optimization_dev\test.m',40,0)">line 40</a>)
fprintf('optimal value: %5.2e \n', fun(opt));
} 
test

gd_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

             maxiter: 100
              report: 1
                 eps: 1.000000000000000e-06
              hspace: 1.000000000000000e-03
     line_search_eps: 1.000000000000000e-04
    line_search_beta: 0.500000000000000
              savefn: 'gd.mat'


loss_params = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    default_chebabs: [1 10]
           chnk_fun: @chnk_poly
         udnorm_ord: 'inf'
          unorm_ord: '2'

Polygon polygon with 8 vertices
